<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Amanda Mejia, Preya Shah &amp; Damon Pham" />

<meta name="date" content="2021-04-05" />

<title>PCA leverage for outlier detection in high-dimensional data with clever</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">PCA leverage for outlier detection in high-dimensional data with <code>clever</code></h1>
<h4 class="author">Amanda Mejia, Preya Shah &amp; Damon Pham</h4>
<h4 class="date">2021-04-05</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">autodep =</span> <span class="cn">TRUE</span>, <span class="at">cache =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div id="overview" class="section level1">
<h1>Overview</h1>
<p><code>clever</code> implements the <em>PCA leverage</em> outlier detection method for high-dimensional (HD) data, as detailed in this manuscript:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">&quot;clever&quot;</span>)[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## 
## Mejia AF, Nebel MB, Eloyan A, Caffo B, Lindquist MA (2017). &quot;PCA
## leverage: outlier detection for high-dimensional functional magnetic
## resonance imaging data.&quot; _Biostatistics_, *18*(3), 521-536. doi:
## 10.1093/biostatistics/kxw050 (URL:
## https://doi.org/10.1093/biostatistics/kxw050).
## 
## A BibTeX entry for LaTeX users is
## 
##   @Article{mejiaPCALeverageOutlier2017a,
##     title = {PCA leverage: outlier detection for high-dimensional functional magnetic resonance imaging data},
##     author = {Amanda F Mejia and Mary Beth Nebel and Ani Eloyan and Brian Caffo and Martin A. Lindquist},
##     journal = {Biostatistics},
##     year = {2017},
##     volume = {18},
##     number = {3},
##     pages = {521--536},
##     publisher = {Oxford University Press},
##     doi = {10.1093/biostatistics/kxw050},
##   }</code></pre>
<p>In summary, the manuscript proposes a measure of “outlyingness” for HD data observations by drawing on the traditional statistical ideas of PCA, leverage, and outlier detection. While its primary application is detecting outlying timepoints in an fMRI scan, the method can also be applied to other forms of HD data such as gene expression data.</p>
<p>In addition to PCA leverage, we have also implemented two other measures of outlyingness: <em>robust distance</em>, described in the same manuscript as PCA leverage, and <em>DVARS</em>, as formulated by this manuscript:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">&quot;clever&quot;</span>)[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## 
## Afyouni S, Nichols TE (2018). &quot;Insight and inference for DVARS.&quot;
## _Neuroimage_, *172*, 291-312. doi: 10.1016/j.neuroimage.2017.12.098
## (URL: https://doi.org/10.1016/j.neuroimage.2017.12.098), This citation
## is for the DVARS measure of outlyingness.
## 
## A BibTeX entry for LaTeX users is
## 
##   @Article{afyouniInsightInferenceDVARS2018a,
##     note = {This citation is for the DVARS measure of outlyingness.},
##     title = {Insight and inference for DVARS},
##     author = {Soroosh Afyouni and Thomas E Nichols},
##     journal = {Neuroimage},
##     year = {2018},
##     volume = {172},
##     pages = {291--312},
##     publisher = {Elsevier},
##     doi = {10.1016/j.neuroimage.2017.12.098},
##   }</code></pre>
<div id="method-outline" class="section level3">
<h3>Method outline</h3>
<p>As input, <code>clever</code> takes a <span class="math inline">\(T\)</span> x <span class="math inline">\(V\)</span> matrix, <span class="math inline">\(Y\)</span>. In our case, <span class="math inline">\(Y\)</span> represents an fMRI run: each row is a vectorized volume, and each column represents one timepoint. Next, the algorithm performs the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Normalize <span class="math inline">\(Y\)</span> by centering and scaling its columns robustly.</p></li>
<li><p>Perform PCA on the normalized <span class="math inline">\(Y\)</span> matrix using the singular value decomposition (SVD) in order to obtain the <span class="math inline">\(T \times T\)</span> PC score matrix, <span class="math inline">\(U\)</span>.</p></li>
<li><p>Some PCs are removed from <span class="math inline">\(U\)</span> to obtain the <span class="math inline">\(Q \times T\)</span> (<span class="math inline">\(Q &lt; T\)</span>) matrix, <span class="math inline">\(U&#39;\)</span>. The PCs which are retained are those likley to contain outlier information: PCs with greater-than-average variance, or PCs with both high variance and high kurtosis. (The removal of at least one PC is also a theoretical requirement for leverage; additionally, the robust distance method requires <span class="math inline">\(Q\)</span> to be appropriately small relative to <span class="math inline">\(T\)</span>.)</p></li>
<li><p>Next, leverage and/or robust distance is measured. The output of each is a length <span class="math inline">\(T\)</span> vector representing the “outlyingness” of each time point.</p></li>
<li><p>The outlyingness measures are thresholded to obtain the set of identified outliers.</p></li>
</ol>
<p>We also include the DVARS outlier detection method in <code>clever</code>. It normalizes the data as explained in step 1 (and not as described in the paper cited above), but otherwise follows the algorithm as described in the paper and implemented in the <a href="https://github.com/asoroosh/DVARS">MATLAB code</a> provided by the authors.</p>
</div>
<div id="installation" class="section level3">
<h3>Installation</h3>
<p>Install the package from GitHub and load it:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;mandymejia/clever&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(clever)</span></code></pre></div>
</div>
</div>
<div id="tutorial" class="section level1">
<h1>Tutorial</h1>
<div id="data" class="section level3">
<h3>Data</h3>
<p><code>clever</code> includes data from the Autism and Brain Imaging Data Exchange (ABIDE), a publicly available resource of neuroimaging and phenotypic information <a href="https://doi.org/10.1038/mp.2013.78">(Di Martino and others, 2014)</a>. Our simulated datasets are based on resting-state fMRI scans from two ABIDE subjects: the first contains artifacts likely due to a couple periods of high subject head motion; the second is relatively artifact-free. Axial slices are used instead of the entire volumes to minimize the download time of <code>clever</code>.</p>
</div>
<div id="example-results" class="section level3">
<h3>Example results</h3>
<p>Here we will run through a simple example. First let’s pull the data:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Dat1)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Dat2)</span></code></pre></div>
<p>The data for both subjects consist of a single slice from an fMRI volume. A brain mask has been applied to vectorize the data, forming a <span class="math inline">\(T \times V\)</span> (time by voxel) matrix.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Dat1)</span></code></pre></div>
<pre><code>## [1]  193 4675</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Dat2)</span></code></pre></div>
<pre><code>## [1]  145 4679</code></pre>
<p>We next run <code>clever</code> on both datasets. First, we will begin by looking at the standard implementation of PCA leverage:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>clever.Dat1.var.lev <span class="ot">=</span> <span class="fu">clever</span>(Dat1, <span class="at">verbose=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Checking for missing, infinite, and constant data.</code></pre>
<pre><code>## Warning in clever_multi(X = X, projection = projection, nuisance = nuisance, : Removing 283 constant data columns (out of 4675).</code></pre>
<pre><code>## Performing nuisance regression.
## Centering and scaling the data columns.
## Computing PCA.
## Computing leverage.</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>clever.Dat2.var.lev <span class="ot">=</span> <span class="fu">clever</span>(Dat2, <span class="at">verbose=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Checking for missing, infinite, and constant data.</code></pre>
<pre><code>## Warning in clever_multi(X = X, projection = projection, nuisance = nuisance, : Removing 68 constant data columns (out of 4679).</code></pre>
<pre><code>## Performing nuisance regression.
## Centering and scaling the data columns.
## Computing PCA.
## Computing leverage.</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot</span>(clever.Dat1.var.lev, <span class="at">title=</span><span class="st">&quot;Dat1&quot;</span>, <span class="at">show.legend=</span><span class="cn">FALSE</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot</span>(clever.Dat2.var.lev, <span class="at">title=</span><span class="st">&quot;Dat2&quot;</span>, <span class="at">show.legend=</span><span class="cn">FALSE</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1, p2, <span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>PCA leverage indicates clear outliers in the first dataset around the 60th and 150th timepoints. While the second dataset is relatively artifact-free, PCA leverage does indicate a few potential outliers including around the 40th and 110th timepoints. We can confirm that the results for DVARS look similar:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">DVARS</span>(Dat1), <span class="at">title=</span><span class="st">&quot;Dat1&quot;</span>, <span class="at">show.legend=</span><span class="cn">FALSE</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">DVARS</span>(Dat2), <span class="at">title=</span><span class="st">&quot;Dat2&quot;</span>, <span class="at">show.legend=</span><span class="cn">FALSE</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1, p2, <span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="fmri-image-reconstruction" class="section level3">
<h3>fMRI image reconstruction</h3>
<p>To validate our results, we can reconstruct the original fMRI images using the mask which was applied to vectorize the data. See <code>clever::Matrix_to_VolumeTimeSeries</code> for a helper function to do this.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(oro.nifti)</span></code></pre></div>
<pre><code>## oro.nifti 0.11.0</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(neurobase)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;  Selects a timepoint from a volume time series, and returns it after adding</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;  the NIfTI header from the mask onto it.</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param VolumeTimeSeries A 4D matrix. Time is on the 4th dimension.</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param time The timepoint to select.</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param mask The corresponding mask.</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return The 3D volume with the NIfTI header from the mask.</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>Volume_to_NIfTI <span class="ot">&lt;-</span> <span class="cf">function</span>(VolumeTimeSeries, time, mask){</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  vol <span class="ot">&lt;-</span> VolumeTimeSeries[,,,time]</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  vol <span class="ot">&lt;-</span> <span class="fu">copyNIfTIHeader</span>(<span class="at">img=</span>mask, <span class="at">arr=</span>vol)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(vol)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">=</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Dat1_mask.nii.gz&quot;</span>, <span class="at">package =</span> <span class="st">&quot;clever&quot;</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>Mask1 <span class="ot">=</span> <span class="fu">readNIfTI</span>(fname) <span class="co">#Pitt_0050048 (full of artifacts)</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>Img1 <span class="ot">=</span> <span class="fu">Matrix_to_VolumeTimeSeries</span>(Dat1, Mask1)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">=</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Dat2_mask.nii.gz&quot;</span>, <span class="at">package =</span> <span class="st">&quot;clever&quot;</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>Mask2 <span class="ot">=</span> <span class="fu">readNIfTI</span>(fname)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>Img2 <span class="ot">=</span> <span class="fu">Matrix_to_VolumeTimeSeries</span>(Dat2, Mask2)</span></code></pre></div>
<p>Below, we compare the timepoint of median leverage (first) to the timepoint of maximum leverage (second) in the first dataset. We choose to use the kurtosis PC-selection method and leverage outlyingness measurement.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>levs <span class="ot">=</span> clever.Dat1.var.lev<span class="sc">$</span>measure</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>t_med <span class="ot">=</span> <span class="fu">order</span>(levs)[<span class="fu">ceiling</span>(<span class="fu">length</span>(levs)<span class="sc">/</span><span class="dv">2</span>)]</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>t_max <span class="ot">=</span> <span class="fu">which.max</span>(levs)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(Img1[,,,t_med], <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&#39;Median leverage (T = &#39;</span>, t_med, <span class="st">&#39;)&#39;</span>))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(Img1[,,,t_max], <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&#39;Maximum leverage (T = &#39;</span>, t_max, <span class="st">&#39;)&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The median time point appears normal, whereas the most outlying time point clearly has banding artifacts likely due to subject motion.</p>
</div>
<div id="leverage-images" class="section level3">
<h3>Leverage images</h3>
<p><code>clever</code> can also display the “leverage images” for each outlying observation. There are two types: the composite of the selected PC directions, weighed by the scores for that observation (without scaling by variance), and the single PC direction with the highest score at that observation.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>clev <span class="ot">&lt;-</span> <span class="fu">clever</span>(Dat1, <span class="at">get_dirs=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning in clever_multi(X = X, projection = projection, nuisance = nuisance, : Removing 283 constant data columns (out of 4675).</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>const_mask <span class="ot">&lt;-</span> <span class="fu">apply</span>(Dat1, <span class="dv">2</span>, sd) <span class="sc">&lt;</span> <span class="fl">1e-8</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>Lev_Img1 <span class="ot">=</span> <span class="fu">lev_images</span>(clev, <span class="at">const_mask=</span>const_mask)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;The timepoints meeting the first outlier level threshold:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## The timepoints meeting the first outlier level threshold:</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">row.names</span>(Lev_Img1<span class="sc">$</span>mean), <span class="at">collapse=</span><span class="st">&quot;, &quot;</span>))</span></code></pre></div>
<pre><code>## 58, 59, 60, 61, 62, 134, 135, 136, 141, 150, 151, 152, 153</code></pre>
<p>Here are the leverage images at timepoint 60 for the first dataset:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Constant voxels are deleted during the `clever` algorithm, so the leverage images will have</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># missing values where the constant voxels were. The NA_fill option is used here to make</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># these voxels have the same color as the background (out-of-mask voxels).</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>Lev_Img1.mean <span class="ot">=</span> <span class="fu">Matrix_to_VolumeTimeSeries</span>(Lev_Img1<span class="sc">$</span>mean, Mask1)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>Lev_Img1.top <span class="ot">=</span> <span class="fu">Matrix_to_VolumeTimeSeries</span>(Lev_Img1<span class="sc">$</span>top, Mask1)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">as.numeric</span>(<span class="fu">row.names</span>(Lev_Img1<span class="sc">$</span>mean)) <span class="sc">==</span> t_max)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(Lev_Img1.mean[,,,idx], <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&#39;Lev. img., mean dir. (T=&#39;</span>,t_max,<span class="st">&#39;)&#39;</span>))</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(Lev_Img1.top[,,,idx], <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&#39;Lev. img., top dir. (T=&#39;</span>,t_max,<span class="st">&#39;)&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The leverage images highlight the banding artifact present at this time point.</p>
</div>
</div>
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<p>For testing purposes, we can run multiple methods at the same time using the internal function <code>clever_multi</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>clever.Dat1.all <span class="ot">&lt;-</span> clever<span class="sc">:::</span><span class="fu">clever_multi</span>(Dat1, <span class="at">projection=</span><span class="st">&quot;all&quot;</span>, <span class="at">verbose=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Checking for missing, infinite, and constant data.</code></pre>
<pre><code>## Warning in clever:::clever_multi(Dat1, projection = &quot;all&quot;, verbose = TRUE): Removing 283 constant data columns (out of 4675).</code></pre>
<pre><code>## Performing nuisance regression.
## Centering and scaling the data columns.
## Computing PCA.
## Computing PCATF.
## Computing ICA.</code></pre>
<pre><code>## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0</code></pre>
<pre><code>## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0

## Warning in lmrob.S(x, y, control = control): find_scale() did not converge in
## &#39;maxit.scale&#39; (= 200) iterations with tol=1e-10, last rel.diff=0</code></pre>
<pre><code>## Computing leverage.</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(clever.Dat1.all) # Doesn&#39;t work yet!</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
