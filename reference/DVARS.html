<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>DVARS — DVARS • fMRIscrub</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="DVARS — DVARS"><meta property="og:description" content="Computes the DSE decomposition and DVARS-related statistics. Based on code
from github.com/asoroosh/DVARS ."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fMRIscrub</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/projection_scrubbing.html">Projection scrubbing for outlier detection in high-dimensional data with `fMRIscrub`</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mandymejia/fMRIscrub/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>DVARS</h1>
    <small class="dont-index">Source: <a href="https://github.com/mandymejia/fMRIscrub/blob/master/R/DVARS.R"><code>R/DVARS.R</code></a></small>
    <div class="hidden name"><code>DVARS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes the DSE decomposition and DVARS-related statistics. Based on code
from github.com/asoroosh/DVARS .</p>
    </div>

    <div class="ref-usage sourceCode"><pre class="sourceCode r"><code><span class="fu">DVARS</span><span class="op">(</span>
  <span class="va">X</span>,
  normalize <span class="op">=</span> <span class="cn">TRUE</span>,
  cutoff_DPD <span class="op">=</span> <span class="fl">5</span>,
  cutoff_ZD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.05</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="fu"><a href="as.matrix2.html">as.matrix2</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>

    <div id="arguments">
    <h2>Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <table class="ref-arguments"><colgroup><col class="name"><col class="desc"></colgroup><tr><th>X</th>
      <td><p>a \(T\) by \(N\) numeric matrix representing an fMRI run. There should
not be any missing data (<code>NA</code> or <code>NaN</code>).</p></td>
    </tr><tr><th>normalize</th>
      <td><p>Normalize the data as proposed in the paper? Default:
<code>TRUE</code>. Normalization removes constant-zero voxels, scales by 100 / the
median of the mean image, and then centers each voxel on its mean.</p>
<p>To replicate Afyouni and Nichols' procedure for the HCP MPP data, since the
HCP scans are already normalized to 10,000, just divide the data by 100 and
center the voxels on their means:</p>
<p><code>Y &lt;- Y/100; DVARS(t(Y - apply(Y, 1, mean)))</code> where <code>Y</code> is the
\(V\) by \(T\) data matrix.</p>
<p>Note that while voxel centering doesn't affect DVARS, it does affect
DPD and ZD.</p></td>
    </tr><tr><th>cutoff_DPD, cutoff_ZD</th>
      <td><p>Numeric outlier cutoffs. Timepoints
exceeding these cutoffs will be flagged as outliers.</p></td>
    </tr><tr><th>verbose</th>
      <td><p>Should occasional updates be printed? Default is <code>FALSE</code>.</p></td>
    </tr></table></div>

    <div id="value">
    <h2>Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with components</p><dl><dt>measure</dt><dd><p>A data.frame with \(T\) rows, each column being a different variant of DVARS.</p></dd>
<dt>measure_info</dt><dd><p>"DVARS"</p></dd>
<dt>outlier_cutoff</dt><dd><p>The outlier cutoff value(s).</p></dd>
<dt>outlier_flag</dt><dd><p>A logical data.frame with \(T\) rows, where <code>TRUE</code> indicates suspected outlier presence.</p></dd>

</dl></div>
    <div id="references">
    <h2>References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    

<ul><li><p>Afyouni, S. &amp; Nichols, T. E. Insight and inference for DVARS. NeuroImage 172, 291-312 (2018).</p></li>
</ul></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Amanda Mejia, John Muschelli, Damon Pham.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

