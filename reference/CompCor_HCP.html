<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Anatomical CompCor for HCP NIFTI and CIFTI data — CompCor_HCP • fMRIscrub</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Anatomical CompCor for HCP NIFTI and CIFTI data — CompCor_HCP"><meta property="og:description" content="Wrapper to CompCor for HCP-format data. Can be used to clean
the surface-based CIFTI data with aCompCor using the noise PCs and ROIs
calculated from the NIFTI fMRI data and NIFTI mask. Can also be used to just
obtain the noise PCs and ROIs without performing aCompCor, if the CIFTI
data is not provided."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fMRIscrub</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/projection_scrubbing.html">Projection scrubbing for outlier detection in high-dimensional data with `fMRIscrub`</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mandymejia/fMRIscrub/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Anatomical CompCor for HCP NIFTI and CIFTI data</h1>
    <small class="dont-index">Source: <a href="https://github.com/mandymejia/fMRIscrub/blob/master/R/CompCor_HCP.R"><code>R/CompCor_HCP.R</code></a></small>
    <div class="hidden name"><code>CompCor_HCP.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Wrapper to <code><a href="CompCor.html">CompCor</a></code> for HCP-format data. Can be used to clean
the surface-based CIFTI data with aCompCor using the noise PCs and ROIs
calculated from the NIFTI fMRI data and NIFTI mask. Can also be used to just
obtain the noise PCs and ROIs without performing aCompCor, if the CIFTI
data is not provided.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class="sourceCode r"><code><span class="fu">CompCor_HCP</span><span class="op">(</span>
  <span class="va">nii</span>,
  <span class="va">nii_labels</span>,
  ROI_noise <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"wm_cort"</span>, <span class="st">"csf"</span><span class="op">)</span>,
  noise_nPC <span class="op">=</span> <span class="fl">5</span>,
  noise_erosion <span class="op">=</span> <span class="cn">NULL</span>,
  idx <span class="op">=</span> <span class="cn">NULL</span>,
  cii <span class="op">=</span> <span class="cn">NULL</span>,
  brainstructures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"right"</span><span class="op">)</span>,
  center <span class="op">=</span> <span class="cn">TRUE</span>,
  scale <span class="op">=</span> <span class="cn">TRUE</span>,
  DCT <span class="op">=</span> <span class="fl">0</span>,
  nuisance_too <span class="op">=</span> <span class="cn">NULL</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>

    <div id="arguments">
    <h2>Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <table class="ref-arguments"><colgroup><col class="name"><col class="desc"></colgroup><tr><th>nii</th>
      <td><p>\(I\) by \(J\) by \(K\) by \(T\)
NIFTI object or array (or file path to the NIFTI) which contains
whole-brain data, including the noise ROIs. In the HCP, the corresponding
file is e.g. "../Results/rfMRI_REST1_LR/rfMRI_REST1_LR.nii.gz"</p></td>
    </tr><tr><th>nii_labels</th>
      <td><p>\(I\) by \(J\) by \(K\)
NIFTI object or array (or file path to the NIFTI) which
contains the corresponding labels to each voxel in <code>nii</code>. Values should
be according to this table:
https://surfer.nmr.mgh.harvard.edu/fswiki/FsTutorial/AnatomicalROI/FreeSurferColorLUT .
In the HCP, the corresponding file is "ROIs/Atlas_wmparc.2.nii.gz".</p></td>
    </tr><tr><th>ROI_noise</th>
      <td><p>A list of numeric vectors. Each entry should represent labels
in <code>nii_labels</code> belonging to a single noise ROI, named by that entry's
name. Or, this can be a character vector of at least one of the following:
<code>"wm_cort"</code> (cortical white matter), <code>"wm_cblm"</code> (cerebellar white
matter), <code>"csf"</code> (cerebrospinal fluid). In the latter case, these labels
will be used:</p>
<dl><dt><code>"wm_cort"</code></dt><dd><p><code>c(3000:4035, 5001, 5002)</code></p></dd>
<dt><code>"wm_cblm"</code></dt><dd><p><code>c(7, 46)</code></p></dd>
<dt><code>"csf"</code></dt><dd><p><code>c(4, 5, 14, 15, 24, 31, 43, 44, 63, 250, 251, 252, 253, 254, 255))</code></p></dd>

</dl><p>These default ROIs are based on this forum post:
https://www.mail-archive.com/hcp-users@humanconnectome.org/msg00931.html</p>
<p>Default: <code>c("wm_cort", "csf")</code></p></td>
    </tr><tr><th>noise_nPC</th>
      <td><p>The number of principal components to compute for each noise
ROI. Alternatively, values between 0 and 1, in which case they will
represent the minimum proportion of variance explained by the PCs used for
each noise ROI. The smallest number of PCs will be used to achieve this
proportion of variance explained.</p>
<p>Should be a list or numeric vector with the same length as <code>ROI_noise</code>.
It will be matched to each ROI based on the name of each entry, or if the
names are missing, the order of entries. If it is an unnamed vector, its
elements will be recycled. Default: <code>5</code> (compute the top 5 PCs for
each noise ROI).</p></td>
    </tr><tr><th>noise_erosion</th>
      <td><p>The number of voxel layers to erode the noise ROIs by.
Should be a list or numeric vector with the same length as <code>ROI_noise</code>.
It will be matched to each ROI based on the name of each entry, or if the
names are missing, the order of entries. If it is an unnamed vector, its
elements will be recycled. Default: <code>NULL</code>, which will use a value of
0 (do not erode the noise ROIs).</p></td>
    </tr><tr><th>idx</th>
      <td><p>A numeric vector indicating the timepoints to use, or
<code>NULL</code> (default) to use all idx. (Indexing begins with 1, so the
first timepoint has index 1 and the last has the same index as the length of
the scan.)</p></td>
    </tr><tr><th>cii</th>
      <td><p><code>"xifti"</code> (or file path to the CIFTI) from which the noise
ROI components will be regressed. In the HCP, the corresponding file is e.g.
"../Results/rfMRI_REST1_LR/rfMRI_REST1_LR_Atlas_MSMAll.dtseries.nii". If not
provided, only the noise components will be returned (no data will be cleaned).</p></td>
    </tr><tr><th>brainstructures</th>
      <td><p>Choose among "left", "right", and "subcortical".
Default: <code>c("left", "right")</code> (cortical data only)</p></td>
    </tr><tr><th>center, scale</th>
      <td><p>Center the columns of the data by median, and scale the
columns of the data by MAD? Default: <code>TRUE</code> for both. Affects both
<code>X</code> and the noise data. <code>center</code> also applies to <code>nuisance_too</code>
so if it is <code>FALSE</code>, <code>nuisance_too</code> must already be centered.</p></td>
    </tr><tr><th>DCT</th>
      <td><p>Add DCT bases to the nuisance regression? Use an integer to
indicate the number of cosine bases. Use <code>0</code> (default) to forgo detrending.</p>
<p>The data must be centered, either before input or with <code>center</code>.</p></td>
    </tr><tr><th>nuisance_too</th>
      <td><p>A matrix of nuisance signals to add to the nuisance
regression. Should have \(T\) rows. <code>NULL</code> to not add additional
nuisance regressors (default).</p></td>
    </tr><tr><th>verbose</th>
      <td><p>Should occasional updates be printed? Default: <code>FALSE</code>.</p></td>
    </tr></table></div>

    <div id="value">
    <h2>Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The noise components, and if <code>cii</code> is provided, the cleaned
surface-based data as a <code>"xifti"</code> object.</p>
    </div>
    <div id="references">
    <h2>References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    

<ul><li><p>Behzadi, Y., Restom, K., Liau, J. &amp; Liu, T. T. A component based noise correction method (CompCor) for BOLD and perfusion based fMRI. NeuroImage 37, 90-101 (2007).</p></li>
<li><p>Muschelli, J. et al. Reduction of motion-related artifacts in resting state fMRI using aCompCor. NeuroImage 96, 22-35 (2014).</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>CompCor</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Amanda Mejia, John Muschelli, Damon Pham.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

